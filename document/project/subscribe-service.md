### 订阅服务
功能： 通过事件通知方式进行路由表的操作，通过订阅数据的方式实现数据的下行路由，通过事件的方式路由通知

``` 
功能设计：
支持平台MQTT 订阅路由： 维护订阅路由表，订阅平台数据和事件，触发事件到接入层；支持应用级订阅(组授权应用)，
设备级订阅，镜像订阅和订阅组订阅(订阅组下的多个设备数据),云端设备工件订阅
支持平台事件三方订阅： 利用pulsar 非持久化topic发送事件，三方直接对接pulsar订阅事件处理；
单机版利用redis发布订阅能力，三方直接订阅redis主题；http同步回调；

实现方案：
利用ConcurrentHashMap本地缓存设备订阅路由表；缓存设备到目的链路设备的map(设备数据到来，寻找路由，存在则发送数据事件到接入层)
需要记录订阅关系到全局路由（redis），用于应用重启恢复使用

主要功能开发：
1. 各种订阅事件处理，添加，删除；首先是判断设备是否在线，在线则进行事件触发路由表处理。
2. 设备上下线事件处理：当设备上线时，会加载订阅路由到本地，并记录全局；当设备下线清理路由；

3. 订阅设备数据：数据到了，查找本地路由，如果存在路由，则对路由表进行聚合，分不同的真实链路进行事件通知
4. 订阅设备事件： 数据到来，查询订阅工件，存在则发送事件到对应的topic,三方订阅事件处理
5. 当应用升级提供服务前首先是读取全局订阅基础信息进行数据恢复

```